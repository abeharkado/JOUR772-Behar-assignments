---
title: "data analysis project"
output: html_document
date: "2024-11-19"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(tidyverse)
library(janitor)
library(lubridate)
library(tidycensus)
```

## Loading data

You can also embed plots, for example:

```{r}
md_pres_vice_data <- read.csv("data/voter_data - president_md.csv") |> clean_names ()
md_pres_vice_data <- md_pres_vice_data |> mutate(total= as.numeric(parse_number(total)))  

pres_election_by_md_counties <- read.csv("data/voter_data - president_county.csv") |> clean_names ()
pres_election_by_md_counties <- pres_election_by_md_counties |> 
  mutate(kamala_d_harris_and_tim_walz_democratic= as.numeric(parse_number(kamala_d_harris_and_tim_walz_democratic)))|>
  mutate(donald_j_trump_and_jd_vance_republican= as.numeric(parse_number(donald_j_trump_and_jd_vance_republican)))|>
  mutate(chase_oliver_and_mike_ter_maat_libertarian= as.numeric(parse_number(chase_oliver_and_mike_ter_maat_libertarian)))|>
  mutate(jill_ellen_stein_and_rudolph_ware_green = as.numeric(parse_number(jill_ellen_stein_and_rudolph_ware_green)))|>
  mutate(robert_f_kennedy_jr_and_nicole_shanahan_unaffiliated= as.numeric(parse_number(robert_f_kennedy_jr_and_nicole_shanahan_unaffiliated)))

senate_overall <- read.csv("data/senate_overall_data.csv") |> clean_names ()
senate_overall <- senate_overall |> mutate(total= as.numeric(parse_number(total)))  

senate_by_county<- read.csv("data/voter_data - senate_county.csv") |> clean_names ()

voter_registration <- read.csv("data/voter_registration.csv")|> clean_names()
voter_registration <- voter_registration |> mutate(total= as.numeric(parse_number(total)))  

elect_2020 <- read.csv("data/voter_data - 2020pres.csv")|> clean_names()
elect_2016 <- read.csv("data/voter_data - 2016pres.csv")|> clean_names()
elect_2012 <- read.csv("data/voter_data - 2012pres.csv")|> clean_names()
elect_2008 <- read.csv("data/voter_data - 2008pres.csv")|> clean_names()
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
# Question 1: How many people had split ballots in Maryland? 

  
pres_votes <- md_pres_vice_data|>
  select(party, total)|>
  mutate(pres_votes= total)|>
  select(party, pres_votes)|>
  filter(str_detect(party, "Democratic|Republican"))

sen_votes <- senate_overall|>
  select(party, total)|>
  mutate(sen_votes= total)|>
  select(party, sen_votes)|> 
 filter(str_detect(party, "Democratic|Republican"))

sen_votes <-sen_votes |>
 group_by(party) |>
 summarise(sen_votes = sum(sen_votes, na.rm = TRUE)) 

split<- pres_votes |> 
  inner_join(sen_votes, by = "party")|>
  mutate(pct_pres = (pres_votes/sum(pres_votes)*100))|>
  mutate(pct_sen = (sen_votes/sum(sen_votes)*100))|>
  mutate(diff = pct_pres - pct_sen)
  

print(split)

```

```{r}
#How many registered voters compared to voter turnout by state and counties? 

pres_election_by_md_counties <- pres_election_by_md_counties|>
  rename(county = jurisdiction)



turnout <- pres_election_by_md_counties|>
  inner_join(voter_registration, by ="county")|>
  rename(democratic = kamala_d_harris_and_tim_walz_democratic)|>
  rename(republican = donald_j_trump_and_jd_vance_republican)|>
  rename(libertarian = chase_oliver_and_mike_ter_maat_libertarian)|>
  rename(green = jill_ellen_stein_and_rudolph_ware_green)|>
  rename(unaffiliated = robert_f_kennedy_jr_and_nicole_shanahan_unaffiliated)



turnout <- turnout|>
  mutate(total_votes = democratic+republican+libertarian+green+unaffiliated)|>
  mutate(diff= total - total_votes)

mean_value <- mean(turnout$diff, na.rm = TRUE)

```

```{r}
#How does the voter turnout compare in counties with different political majorities? 

turnout <- turnout|>
  mutate(
    win= case_when(
    (democratic > republican) ~ "TRUE",
    (democratic < republican) ~"FALSE"
  ))

turnout_county <- turnout |>
  select(county, diff, win)|>
  arrange(diff)
```

```{r}
#Based on current voting data, how might voting patterns in Maryland change in upcoming elections?
elect_2008 <- elect_2008|>
  select(party, percentage)
elect_2012 <- elect_2012|>
  select(party, percentage)
elect_2016 <- elect_2016|>
  select(party, percentage)
elect_2020 <- elect_2020|>
  select(party, percentage)
elect_2024 <- md_pres_vice_data|>
  select(party, percentage)


patterns <- elect_2008 |>
  inner_join(elect_2012, by="party")|>
  rename(elect_2008 = percentage.x)|>
  rename(elect_2012 = percentage.y)|>
  inner_join(elect_2016, by="party")|>
  rename(elect_2016 = percentage)|>
  inner_join(elect_2020, by="party")|>
  rename(elect_2020 = percentage)|>
  inner_join(elect_2024, by="party")|>
  rename(elect_2024 = percentage)

patterns <- patterns|>
  mutate(prediction = elect_2008+elect_2012+elect_2016+elect_2020+elect_2024)
  
  


```

```{r}
#What senate election had the highest turnout by county? 

```
